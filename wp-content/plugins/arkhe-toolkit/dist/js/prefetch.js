!function(){console.log("[Arkhe Toolkit] prefetch.js");!function(){if(!function(){const e=document.createElement("link");return!(!(e.relList&&e.relList.supports&&e.relList.supports("prefetch"))||!window.IntersectionObserver||!("isIntersecting"in IntersectionObserverEntry.prototype)||"undefined"==typeof Promise||navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g")))}())return;const e=new Set,t=new Set,n="ontouchstart"in window||navigator.maxTouchPoints>0||window.matchMedia("(pointer:coarse)").matches,o={delay:0,maxRPS:3,hoverDelay:50,observerDelay:500,ignoreKeywords:["/wp-admin/","/wp-admin/",...(null===(a=window.arkhePrefetchVars)||void 0===a?void 0:a.ignorePrefetchKeys)||[]],...window.arkhePrefetchConfig},r=e=>{const t=setTimeout((()=>{m(),console.log("レスポンスが遅いため、プリロードを中断しました: "+e)}),5e3);(e=>new Promise(((t,n)=>{const o=document.createElement("link");o.rel="prefetch",o.href=e,o.onload=t,o.onerror=n,document.head.appendChild(o)})))(e).then((()=>{})).catch((t=>{console.error(t,e)})).finally((()=>clearTimeout(t)))},s=function(n){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.has(n)||e.has(n))return;const i=window.location.origin;if(n.substring(0,i.length)!==i)return;if(window.location.href===n)return;const a=o.ignoreKeywords.some((e=>n.includes(e)));a||(s?(r(n),t.add(n)):e.add(n))},i=new IntersectionObserver((e=>{n&&e.forEach((e=>{if(e.isIntersecting){const t=e.target.href;setTimeout((()=>{s(t,0===o.maxRPS)}),o.observerDelay)}}))}));var a;let c=null;const l=e=>{const n=e.target.closest("a");null!=n&&n.href&&!t.has(n.href)&&(c=setTimeout((()=>{s(n.href,!0)}),o.hoverDelay))},u=e=>{const n=e.target.closest("a");null!=n&&n.href&&!t.has(n.href)&&s(n.href,!0)},d=e=>{const n=e.target.closest("a");null!=n&&n.href&&!t.has(n.href)&&clearTimeout(c)},h=window.requestIdleCallback||function(e){const t=Date.now();return setTimeout((()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})}),1)},m=()=>{document.querySelectorAll("a").forEach((e=>i.unobserve(e))),e.clear(),n?document.removeEventListener("touchstart",u,!0):(document.removeEventListener("mouseover",l,!0),document.removeEventListener("mouseout",d,!0))};setInterval((()=>{Array.from(e).slice(0,o.maxRPS).forEach((n=>{r(n),t.add(n),e.delete(n)}))}),1e3),h((()=>setTimeout((()=>document.querySelectorAll("a").forEach((e=>i.observe(e)))),1e3*o.delay)));const f={capture:!0,passive:!0};n?document.addEventListener("touchstart",u,f):(document.addEventListener("mouseover",l,f),document.addEventListener("mouseout",d,f))}()}();