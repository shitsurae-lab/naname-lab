!function(e){var n,t=!1;function r(){var e="test";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(n){return!1}}function i(e,n){var t=e.getItem(n);return t&&JSON.parse(t)}function a(a){if(!t){t=!0;var s=cf7msm_posted_data,f=e("input[name='_cf7msm_multistep_tag']"),o=f.length>0;if(o||(o=(f=e("input[name='cf7msm-step']")).length>0),o){var l=f.closest("form"),c=l.find('input[name="_wpcf7"]').val();r()?null!=(n=i(sessionStorage,"cf7msm"))&&e.each(n,function(e,n){if("cf7msm_prev_urls"==e){var t=l.find(".wpcf7-back, .wpcf7-previous"),r=window.location.href,i=r.replace(/\/$/,""),a=!n.hasOwnProperty(r)||""==n[r];a&&(a=!n.hasOwnProperty(i)||""==n[i]),a&&(r=r.split("?")[0],i=r.replace(/\/$/,""),(a=!n.hasOwnProperty(r)||""==n[r])&&(a=!n.hasOwnProperty(i)||""==n[i])),a?t.hide():t.click(function(e){n.hasOwnProperty(r)&&""!=n[r]?window.location.href=n[r]:n.hasOwnProperty(i)&&""!=n[i]?window.location.href=n[i]:window.history.go(-1),e.preventDefault()})}}):(e("input[name='cf7msm-no-ss']").val(1),e(".wpcf7-previous").hide());var p=wpcf7.submit;wpcf7.submit=function(n,t){!function(n){(function(n){var t=n;t instanceof jQuery||(t=e(n));var r=t.find("input[name='_cf7msm_multistep_tag']");if(0==r.length)return;r.length>1&&(r=r.last());e("<input />",{type:"hidden",name:"cf7msm_options",value:r.val()}).appendTo(t)})(n),function(n){var t=n;t instanceof jQuery||(t=e(n));var r=e(".has-free-text",t);r.each(function(){var n=e(this),t=e("input:checkbox",n);if(0==t.length&&(t=e("input:radio",n)),0==t.length)return!1;var r=t.attr("name");r.indexOf("[]")===r.length-2&&(r=r.substring(0,r.length-2));var i="_cf7msm_free_text_reflen_"+r,a=e('input[name="'+i+'"]',n);t.is(":checked")?(0==a.length&&(a=e('<input type="hidden" name="'+i+'">'),n.append(a)),a.val(t.val().length)):a.length>0&&a.remove()})}(n)}(n),p(n,t)},a&&u(),window.addEventListener("load",function(){u()}),document.addEventListener("wpcf7mailsent",function(t){var a,s,f,o=e("#"+t.detail.unitTag+" form");if(r()){var l=0,p=0,u=[],m={};(n=i(sessionStorage,"cf7msm"))||(n={});var d=!1,h=!1,v=!0,_=!1,g=null,w=!1,x=e(".has-free-text",o),y={};if(e.each(t.detail.inputs,function(n){var r=t.detail.inputs[n].name,i=t.detail.inputs[n].value,a=e('input[name="'+r+'"]',x);if(a.length>0&&a.is(":checked")){var s=r;r.indexOf("[]")===r.length-2&&(s=r.substring(0,r.length-2));var f=i.length,o=e('input[name="_wpcf7_free_text_'+s+'"]',x).val(),O="_cf7msm_free_text_reflen_"+s;r.indexOf("[]")===r.length-2?y[r]={value:i,free_text:o,ref_len:f,ref_name:O}:(i+=" "+o,m[O]=f)}if(r.indexOf("[]")===r.length-2?(-1===e.inArray(r,u)&&(m[r]=[]),m[r].push(i)):m[r]=i,"cf7msm-step"===r){if(-1!==i.indexOf("-")){d=!0,h=!1;var k=i.split("-");l=parseInt(k[0]),p=parseInt(k[1]),void 0!==cf7msm_redirect_urls[c]&&(g=cf7msm_redirect_urls[c]),l<p?v=!1:l===p&&(_=!0)}}else if("cf7msm_options"===r){d=!0,h=!0,v=!1;var b=JSON.parse(i);b.hasOwnProperty("next_url")&&(g=b.next_url),b.hasOwnProperty("last_step")&&(w=!0,g&&""!==g||(_=!0,v=!0))}else u.push(r)}),e.each(y,function(e,n){if(m.hasOwnProperty(e)&&m[e].length>0){var t=m[e].length-1;m[e][t]===n.value&&(m[e][t]+=" "+n.free_text,m[n.ref_name]=n.ref_len)}}),!d)return;if(!v){var O=e("#"+t.detail.unitTag).find("div.wpcf7-mail-sent-ok");0==O.length&&(O=e("#"+t.detail.unitTag).find(".wpcf7-response-output")),O.remove()}if(_&&(o.find("*").not("div.wpcf7-response-output").hide(),o.find("div.wpcf7-response-output").parentsUntil("form").show()),h?w&&(n={}):0!=l&&l===p&&(n={}),g&&""!=g){var k=document.createElement("a");k.href=g;var b=k.hostname+(k.port?":"+k.port:""),P={};n&&n.cf7msm_prev_urls&&(P=n.cf7msm_prev_urls);var S=window.location.protocol+"//"+window.location.host;0===g.indexOf(S)||""!=b&&b!=window.location.host||(0!==g.indexOf("/")&&(S+="/"),g=S+g),P[g]=window.location.href;var I=g.split("?")[0];g!=I&&(P[I]=window.location.href),n.cf7msm_prev_urls=P}a=sessionStorage,s="cf7msm",f=n,a.setItem(s,JSON.stringify(f)),g&&""!=g&&(window.location.href=g)}},!1)}}function u(){s&&(e.each(s,function(n,t){if(n.indexOf("[]")===n.length-2&&(n=n.substring(0,n.length-2)),0!=n.indexOf("_")&&"cf7msm-step"!=n&&"cf7msm_options"!=n){var r=l.find('*[name="'+n+'"]:not([data-cf7msm-previous])'),i=l.find('input[name="'+n+'[]"]:not([data-cf7msm-previous])'),a=l.find('select[name="'+n+'[]"]:not([data-cf7msm-previous])');if(r.length>0)if("radio"==r.prop("type")||"checkbox"==r.prop("type")){if(null!==(f=m(s,n,t)))(o=r.filter('[value="'+f.new_val+'"]')).length>0&&(e('input[name="_wpcf7_free_text_'+n+'"]',l).val(f.free_val),t=f.new_val);r.filter(function(){return e(this).val()==t}).prop("checked",!1).trigger("click",[{cf7msm:!0}])}else r.is("select")?r.find("option").filter(function(){return this.value==t}).prop("selected",!0):r.val(t);else if(i.length>0&&t.constructor===Array){""!=t&&t.length>0&&e.each(t,function(n,t){i.filter(function(){return e(this).val()==t}).prop("checked",!1).trigger("click",[{cf7msm:!0}])});var f,o,c=t[t.length-1];if(null!==(f=m(s,n,c)))if((o=i.filter('[value="'+f.new_val+'"]')).length>0)o.prop("checked",!1).trigger("click",[{cf7msm:!0}]),e('input[name="_wpcf7_free_text_'+n+'"]').val(f.free_val)}else a.length>0&&t.constructor===Array&&""!=t&&t.length>0&&e.each(t,function(e,n){a.find("option").filter(function(){return this.value==n}).prop("selected",!0)})}}),l.find('input[name="_wpcf7cf_options"]').trigger("change"))}function m(e,n,t){var r=t;t.constructor===Array&&(r=t[t.length-1]);var i=null,a="_cf7msm_free_text_reflen_"+n;if(a in e){var s=parseInt(e[a]);s<=r.length&&(i={new_val:r.substring(0,s),free_val:r.substring(s+1)})}return i}}window.addEventListener("DOMContentLoaded",e=>{a()}),window.addEventListener("pagehide",e=>{t=!1}),window.addEventListener("pageshow",e=>{a(e.persisted)})}(jQuery);
